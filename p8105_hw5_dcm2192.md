p8105_hw5_dcm2192
================
Dylan Morgan
2024-11-15

``` r
library(tidyverse)
library(rvest)
set.seed(1)
```

### Problem 1

### Problem 2

Define function.

``` r
sim_mean_sd <- function(mu, n = 30, sigma = 5) {
  sim_data = tibble(
    x = rnorm(n, mean = mu, sd = sigma)
  )
  sim_data |> 
    t.test() |> 
    broom::tidy() |> 
    summarize(
      mu_hat = estimate, 
      p_value = p.value
    )
}
```

Datasets with mu 0-6.

``` r
sim_results_df <- 
  expand_grid(
    mu = c(0:6),
    iter = 1:5000
  ) |> 
  mutate(
    estimate_df = map(mu, sim_mean_sd)
  ) |> 
  unnest(estimate_df)
```

Plot mu 0-6 where null was rejected.

``` r
sim_results_df |> 
  filter(p_value <= 0.05) |> 
  group_by(mu) |> 
  summarize(n_obs = n()) |> 
  ggplot(aes(x = mu, y = n_obs)) + 
  geom_point() + 
  geom_line() + 
  labs(x = "True value of mu", y = "Number of times null was rejected")
```

![](p8105_hw5_dcm2192_files/figure-gfm/unnamed-chunk-3-1.png)<!-- -->

The relationship between effect size and power is such that the number
of times the null is rejected increases as the true value of mu
increases.

Plot avg estimate of mu-hat and true value of mu.

``` r
sim_results_df |> 
  group_by(mu) |> 
  summarize(avg_mu_hat = mean(mu_hat)) |> 
  ggplot(aes(x = mu, y = avg_mu_hat)) + 
  geom_point() + 
  geom_line() + 
  labs(x = "True value of mu", y = "Average estimate of mu-hat")
```

![](p8105_hw5_dcm2192_files/figure-gfm/unnamed-chunk-4-1.png)<!-- -->

Plot avg estimate of mu-hat (where null was rejected) and true value of
mu.

``` r
sim_results_df |> 
  filter(p_value <= 0.05) |> 
  group_by(mu) |> 
  summarize(avg_mu_hat = mean(mu_hat)) |> 
  ggplot(aes(x = mu, y = avg_mu_hat)) + 
  geom_point() + 
  geom_line() + 
  labs(x = "True value of mu", y = "Average estimate of mu-hat where null was rejected")
```

![](p8105_hw5_dcm2192_files/figure-gfm/unnamed-chunk-5-1.png)<!-- -->

### Problem 3
